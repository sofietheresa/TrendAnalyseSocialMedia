2025-05-15 10:10:20,483 [INFO] Starting Reddit scraping...
2025-05-15 10:10:32,453 [INFO] Successfully stored 128 Reddit posts in the database
2025-05-15 10:25:14,122 [INFO] Starting Reddit scraping...
2025-05-15 10:25:14,122 [INFO] Starting Reddit scraping...
2025-05-15 10:25:24,051 [INFO] Successfully stored 127 Reddit posts in the database
2025-05-15 10:25:24,051 [INFO] Successfully stored 127 Reddit posts in the database
2025-05-15 10:26:45,993 [INFO] Starting Reddit scraping...
2025-05-15 10:26:56,943 [ERROR] Error during Reddit scraping: ON CONFLICT DO UPDATE command cannot affect row a second time
HINT:  Ensure that no rows proposed for insertion within the same command have duplicate constrained values.

2025-05-15 10:26:56,951 [ERROR] Detailed error:
Traceback (most recent call last):
  File "C:\Users\SofiePischl\Documents\01_HdM\10_ML_OPS\TrendAnalyseSocialMedia\src\scheduler\jobs\reddit_scraper.py", line 153, in scrape_reddit
    execute_values(cur, insert_query, values)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SofiePischl\Documents\01_HdM\10_ML_OPS\TrendAnalyseSocialMedia\venv\Lib\site-packages\psycopg2\extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
psycopg2.errors.CardinalityViolation: ON CONFLICT DO UPDATE command cannot affect row a second time
HINT:  Ensure that no rows proposed for insertion within the same command have duplicate constrained values.

2025-05-15 10:28:01,051 [INFO] Starting Reddit scraping...
2025-05-15 10:28:10,819 [ERROR] Error during Reddit scraping: ON CONFLICT DO UPDATE command cannot affect row a second time
HINT:  Ensure that no rows proposed for insertion within the same command have duplicate constrained values.

2025-05-15 10:28:10,819 [ERROR] Detailed error:
Traceback (most recent call last):
  File "C:\Users\SofiePischl\Documents\01_HdM\10_ML_OPS\TrendAnalyseSocialMedia\src\scheduler\jobs\reddit_scraper.py", line 153, in scrape_reddit
    execute_values(cur, insert_query, values)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SofiePischl\Documents\01_HdM\10_ML_OPS\TrendAnalyseSocialMedia\venv\Lib\site-packages\psycopg2\extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
psycopg2.errors.CardinalityViolation: ON CONFLICT DO UPDATE command cannot affect row a second time
HINT:  Ensure that no rows proposed for insertion within the same command have duplicate constrained values.

2025-05-15 10:32:13,701 [INFO] Starting Reddit scraping...
2025-05-15 10:32:13,717 [INFO] Successfully connected to Reddit API
2025-05-15 10:32:13,717 [INFO] Scraping subreddit: r/all
2025-05-15 10:32:15,532 [INFO] Found 3 posts in r/all
2025-05-15 10:32:15,533 [INFO] Scraping subreddit: r/popular
2025-05-15 10:32:16,896 [INFO] Found 6 posts in r/popular
2025-05-15 10:32:16,896 [INFO] Scraping subreddit: r/trendingreddits
2025-05-15 10:32:17,835 [INFO] Found 21 posts in r/trendingreddits
2025-05-15 10:32:17,835 [INFO] Scraping subreddit: r/trendingsubreddits
2025-05-15 10:32:20,036 [INFO] Found 100 posts in r/trendingsubreddits
2025-05-15 10:32:20,037 [INFO] Found 127 unique posts out of 130 total posts
2025-05-15 10:32:23,054 [ERROR] Error during Reddit scraping: ON CONFLICT DO UPDATE command cannot affect row a second time
HINT:  Ensure that no rows proposed for insertion within the same command have duplicate constrained values.

2025-05-15 10:32:23,055 [ERROR] Detailed error:
Traceback (most recent call last):
  File "C:\Users\SofiePischl\Documents\01_HdM\10_ML_OPS\TrendAnalyseSocialMedia\src\scheduler\jobs\reddit_scraper.py", line 166, in scrape_reddit
    execute_values(cur, insert_query, values)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SofiePischl\Documents\01_HdM\10_ML_OPS\TrendAnalyseSocialMedia\venv\Lib\site-packages\psycopg2\extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
psycopg2.errors.CardinalityViolation: ON CONFLICT DO UPDATE command cannot affect row a second time
HINT:  Ensure that no rows proposed for insertion within the same command have duplicate constrained values.

2025-05-15 10:33:45,232 [INFO] Starting Reddit scraping...
2025-05-15 10:33:45,233 [INFO] Successfully connected to Reddit API
2025-05-15 10:33:45,233 [INFO] Scraping subreddit: r/all
2025-05-15 10:33:47,112 [INFO] Found 3 posts in r/all
2025-05-15 10:33:47,112 [INFO] Scraping subreddit: r/popular
2025-05-15 10:33:48,454 [INFO] Found 6 posts in r/popular
2025-05-15 10:33:48,454 [INFO] Scraping subreddit: r/trendingreddits
2025-05-15 10:33:49,462 [INFO] Found 21 posts in r/trendingreddits
2025-05-15 10:33:49,462 [INFO] Scraping subreddit: r/trendingsubreddits
2025-05-15 10:33:51,932 [INFO] Found 100 posts in r/trendingsubreddits
2025-05-15 10:33:51,932 [INFO] Found 127 unique posts out of 130 total posts
2025-05-15 10:33:54,191 [ERROR] Error processing batch: ON CONFLICT DO UPDATE command cannot affect row a second time
HINT:  Ensure that no rows proposed for insertion within the same command have duplicate constrained values.

2025-05-15 10:33:54,790 [ERROR] Error processing batch: relation "reddit_data" does not exist
LINE 2:                             INSERT INTO reddit_data (
                                                ^

2025-05-15 10:33:55,387 [ERROR] Error processing batch: relation "reddit_data" does not exist
LINE 2:                             INSERT INTO reddit_data (
                                                ^

2025-05-15 10:33:55,989 [ERROR] Error processing batch: relation "reddit_data" does not exist
LINE 2:                             INSERT INTO reddit_data (
                                                ^

2025-05-15 10:33:56,587 [ERROR] Error processing batch: relation "reddit_data" does not exist
LINE 2:                             INSERT INTO reddit_data (
                                                ^

2025-05-15 10:33:57,190 [ERROR] Error processing batch: relation "reddit_data" does not exist
LINE 2:                             INSERT INTO reddit_data (
                                                ^

2025-05-15 10:33:57,789 [ERROR] Error processing batch: relation "reddit_data" does not exist
LINE 2:                             INSERT INTO reddit_data (
                                                ^

2025-05-15 10:33:58,420 [ERROR] Error processing batch: relation "reddit_data" does not exist
LINE 2:                             INSERT INTO reddit_data (
                                                ^

2025-05-15 10:33:59,069 [ERROR] Error processing batch: relation "reddit_data" does not exist
LINE 2:                             INSERT INTO reddit_data (
                                                ^

2025-05-15 10:33:59,667 [ERROR] Error processing batch: relation "reddit_data" does not exist
LINE 2:                             INSERT INTO reddit_data (
                                                ^

2025-05-15 10:34:00,265 [ERROR] Error processing batch: relation "reddit_data" does not exist
LINE 2:                             INSERT INTO reddit_data (
                                                ^

2025-05-15 10:34:00,867 [ERROR] Error processing batch: relation "reddit_data" does not exist
LINE 2:                             INSERT INTO reddit_data (
                                                ^

2025-05-15 10:34:01,464 [ERROR] Error processing batch: relation "reddit_data" does not exist
LINE 2:                             INSERT INTO reddit_data (
                                                ^

2025-05-15 10:34:01,662 [INFO] Successfully processed 127 Reddit posts (0 inserted, 0 updated)
2025-05-15 10:34:47,400 [INFO] Starting Reddit scraping...
2025-05-15 10:34:47,401 [INFO] Successfully connected to Reddit API
2025-05-15 10:34:47,401 [INFO] Scraping subreddit: r/all
2025-05-15 10:34:49,629 [INFO] Found 3 posts in r/all
2025-05-15 10:34:49,629 [INFO] Scraping subreddit: r/popular
2025-05-15 10:34:51,422 [INFO] Found 6 posts in r/popular
2025-05-15 10:34:51,422 [INFO] Scraping subreddit: r/trendingreddits
2025-05-15 10:34:52,327 [INFO] Found 21 posts in r/trendingreddits
2025-05-15 10:34:52,327 [INFO] Scraping subreddit: r/trendingsubreddits
2025-05-15 10:34:54,791 [INFO] Found 100 posts in r/trendingsubreddits
2025-05-15 10:34:54,792 [INFO] Found 127 unique posts out of 130 total posts
2025-05-15 10:34:57,445 [ERROR] Error processing batch: ON CONFLICT DO UPDATE command cannot affect row a second time
HINT:  Ensure that no rows proposed for insertion within the same command have duplicate constrained values.

2025-05-15 10:35:05,346 [INFO] Successfully processed 117 Reddit posts (0 inserted, 0 updated)
2025-05-15 10:35:55,688 [INFO] Starting Reddit scraping...
2025-05-15 10:35:55,689 [INFO] Successfully connected to Reddit API
2025-05-15 10:35:55,690 [INFO] Scraping subreddit: r/all
2025-05-15 10:35:57,431 [INFO] Found 3 posts in r/all
2025-05-15 10:35:57,431 [INFO] Scraping subreddit: r/popular
2025-05-15 10:35:58,707 [INFO] Found 6 posts in r/popular
2025-05-15 10:35:58,708 [INFO] Scraping subreddit: r/trendingreddits
2025-05-15 10:35:59,651 [INFO] Found 21 posts in r/trendingreddits
2025-05-15 10:35:59,651 [INFO] Scraping subreddit: r/trendingsubreddits
2025-05-15 10:36:02,345 [INFO] Found 100 posts in r/trendingsubreddits
2025-05-15 10:36:02,345 [INFO] Found 127 unique posts out of 130 total posts
2025-05-15 10:37:21,498 [INFO] Successfully processed 127 Reddit posts (8 inserted, 119 updated)
