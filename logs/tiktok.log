2025-05-15 10:17:05,943 [INFO] Using browser: chromium
2025-05-15 10:17:05,943 [INFO] Creating TikTok API session...
2025-05-15 10:17:17,721 [INFO] TikTok API session created successfully
2025-05-15 10:17:17,722 [INFO] Loading trending videos from TikTok...
2025-05-15 10:17:20,698 [INFO] Found 58 videos, attempting to store in database...
2025-05-15 10:17:23,675 [ERROR] Error during TikTok scraping: CardinalityViolation: ON CONFLICT DO UPDATE command cannot affect row a second time
HINT:  Ensure that no rows proposed for insertion within the same command have duplicate constrained values.

2025-05-15 10:17:23,709 [ERROR] Traceback (most recent call last):
  File "C:\Users\SofiePischl\Documents\01_HdM\10_ML_OPS\TrendAnalyseSocialMedia\src\scheduler\jobs\tiktok_scraper.py", line 175, in trending_videos
    execute_values(cur, insert_query, values)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SofiePischl\Documents\01_HdM\10_ML_OPS\TrendAnalyseSocialMedia\venv\Lib\site-packages\psycopg2\extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
psycopg2.errors.CardinalityViolation: ON CONFLICT DO UPDATE command cannot affect row a second time
HINT:  Ensure that no rows proposed for insertion within the same command have duplicate constrained values.


2025-05-15 10:17:23,732 [INFO] Closing browser session...
2025-05-15 10:17:24,005 [INFO] Browser session closed
2025-05-15 10:18:10,680 [INFO] Using browser: chromium
2025-05-15 10:18:10,681 [INFO] Creating TikTok API session...
2025-05-15 10:18:19,522 [INFO] TikTok API session created successfully
2025-05-15 10:18:19,522 [INFO] Loading trending videos from TikTok...
2025-05-15 10:18:22,472 [INFO] Found 46 unique videos, attempting to store in database...
2025-05-15 10:18:35,351 [INFO] Successfully processed 46 videos (46 inserted, 0 updated)
2025-05-15 10:18:35,352 [INFO] Closing browser session...
2025-05-15 10:18:35,787 [INFO] Browser session closed
2025-05-15 10:25:24,073 [INFO] Using browser: chromium
2025-05-15 10:25:24,073 [INFO] Using browser: chromium
2025-05-15 10:25:24,073 [INFO] Creating TikTok API session...
2025-05-15 10:25:24,073 [INFO] Creating TikTok API session...
2025-05-15 10:25:33,153 [INFO] TikTok API session created successfully
2025-05-15 10:25:33,153 [INFO] TikTok API session created successfully
2025-05-15 10:25:33,154 [INFO] Loading trending videos from TikTok...
2025-05-15 10:25:33,154 [INFO] Loading trending videos from TikTok...
2025-05-15 10:25:35,673 [INFO] Found 42 unique videos, attempting to store in database...
2025-05-15 10:25:35,673 [INFO] Found 42 unique videos, attempting to store in database...
2025-05-15 10:25:46,019 [INFO] Successfully processed 42 videos (28 inserted, 14 updated)
2025-05-15 10:25:46,019 [INFO] Successfully processed 42 videos (28 inserted, 14 updated)
2025-05-15 10:25:46,020 [INFO] Closing browser session...
2025-05-15 10:25:46,020 [INFO] Closing browser session...
2025-05-15 10:25:46,294 [INFO] Browser session closed
2025-05-15 10:25:46,294 [INFO] Browser session closed
2025-05-15 10:26:57,020 [INFO] Using browser: chromium
2025-05-15 10:26:57,020 [INFO] Creating TikTok API session...
2025-05-15 10:27:06,288 [INFO] TikTok API session created successfully
2025-05-15 10:27:06,288 [INFO] Loading trending videos from TikTok...
2025-05-15 10:27:08,959 [INFO] Found 49 unique videos, attempting to store in database...
2025-05-15 10:27:11,444 [ERROR] Error inserting video 7500052768854527239: value too long for type character varying(500)

2025-05-15 10:27:11,644 [ERROR] Error inserting video 7501054052168404255: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:11,844 [ERROR] Error inserting video 7476823939214216450: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:12,043 [ERROR] Error inserting video 7481775457415761198: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:12,243 [ERROR] Error inserting video 7501480772889627922: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:12,443 [ERROR] Error inserting video 7494696063702404374: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:12,642 [ERROR] Error inserting video 7474118918395661575: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:12,842 [ERROR] Error inserting video 7471679068027522326: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:13,041 [ERROR] Error inserting video 7474528587148758295: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:13,239 [ERROR] Error inserting video 7498879676245658926: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:13,439 [ERROR] Error inserting video 7492757313153994006: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:13,638 [ERROR] Error inserting video 7475814602916334870: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:13,836 [ERROR] Error inserting video 7496039067130334470: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:14,036 [ERROR] Error inserting video 7496914740623559958: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:14,236 [ERROR] Error inserting video 7483152862151806263: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:14,434 [ERROR] Error inserting video 7503639568281881878: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:14,633 [ERROR] Error inserting video 7502861868353080598: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:14,832 [ERROR] Error inserting video : current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:15,031 [ERROR] Error inserting video 7476648017790012678: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:15,230 [ERROR] Error inserting video 7473144580179774738: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:15,430 [ERROR] Error inserting video 7503541894769560854: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:15,629 [ERROR] Error inserting video 7479456244944751894: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:15,827 [ERROR] Error inserting video 7481813647522598166: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:16,026 [ERROR] Error inserting video 7503868936870432022: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:16,224 [ERROR] Error inserting video 7483581945390173462: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:16,423 [ERROR] Error inserting video 7476642558618225942: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:16,624 [ERROR] Error inserting video 7498014529620692246: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:16,823 [ERROR] Error inserting video 7497685667518926088: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:17,022 [ERROR] Error inserting video 7503925557046856993: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:17,222 [ERROR] Error inserting video 7474302176660147478: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:17,420 [ERROR] Error inserting video 7500744842771729670: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:17,619 [ERROR] Error inserting video 7500893295145536790: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:17,819 [ERROR] Error inserting video 7475062603996237057: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:18,019 [ERROR] Error inserting video 7478360823220440325: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:18,229 [ERROR] Error inserting video 7494291431025036566: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:18,428 [ERROR] Error inserting video 7472307236350463254: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:18,627 [ERROR] Error inserting video 7491995339071720726: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:18,826 [ERROR] Error inserting video 7497754448006040854: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:19,024 [ERROR] Error inserting video 7485308200527498498: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:19,222 [ERROR] Error inserting video 7473376559013907734: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:19,420 [ERROR] Error inserting video 7477991944031964438: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:19,619 [ERROR] Error inserting video 7475114379977968918: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:19,817 [ERROR] Error inserting video 7494793912201055543: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:20,016 [ERROR] Error inserting video 7491951798823980310: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:20,215 [ERROR] Error inserting video 7479585258816474390: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:20,413 [ERROR] Error inserting video 7484270224783592710: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:20,612 [ERROR] Error inserting video 7472779684124675350: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:20,812 [INFO] Successfully processed 49 videos (2 inserted, 0 updated)
2025-05-15 10:27:20,812 [INFO] Closing browser session...
2025-05-15 10:27:20,990 [INFO] Browser session closed
2025-05-15 10:28:16,159 [INFO] Using browser: chromium
2025-05-15 10:28:16,159 [INFO] Creating TikTok API session...
2025-05-15 10:28:27,060 [INFO] TikTok API session created successfully
2025-05-15 10:28:27,060 [INFO] Loading trending videos from TikTok...
2025-05-15 10:28:28,428 [INFO] Found 30 unique videos, attempting to store in database...
2025-05-15 10:28:30,848 [ERROR] Error inserting video 7501767141276781842: value too long for type character varying(500)

2025-05-15 10:28:31,049 [ERROR] Error inserting video 7502820049514827054: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:31,249 [ERROR] Error inserting video 7497677779564121350: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:31,449 [ERROR] Error inserting video 7497584770533068074: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:31,648 [ERROR] Error inserting video 7484651212701289750: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:31,906 [ERROR] Error inserting video 7502407828070567190: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:32,105 [ERROR] Error inserting video 7501393704754728214: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:32,353 [ERROR] Error inserting video 7492757313153994006: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:32,557 [ERROR] Error inserting video 7476823939214216450: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:32,762 [ERROR] Error inserting video 7503659125176372503: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:32,967 [ERROR] Error inserting video 7501480772889627922: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:33,172 [ERROR] Error inserting video 7500533345068010774: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:33,377 [ERROR] Error inserting video 7503543054603767062: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:33,582 [ERROR] Error inserting video 7494793912201055543: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:33,782 [ERROR] Error inserting video 7503598295923658027: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:33,991 [ERROR] Error inserting video 7503869597167127825: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:34,195 [ERROR] Error inserting video 7495116577369509150: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:34,401 [ERROR] Error inserting video 7503690966822440223: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:34,603 [ERROR] Error inserting video 7501768849553919254: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:34,823 [ERROR] Error inserting video 7501682466655161622: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:35,022 [ERROR] Error inserting video : current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:35,263 [ERROR] Error inserting video 7502450730058435862: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:35,462 [ERROR] Error inserting video 7497754448006040854: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:35,662 [ERROR] Error inserting video 7496914740623559958: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:35,863 [ERROR] Error inserting video 7503865645805751574: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:36,062 [ERROR] Error inserting video 7495363069288205600: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:36,261 [ERROR] Error inserting video 7500052768854527239: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:36,461 [ERROR] Error inserting video 7473144580179774738: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:36,661 [ERROR] Error inserting video 7503944989190180118: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:36,861 [ERROR] Error inserting video 7496039067130334470: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:37,061 [INFO] Successfully processed 30 videos (0 inserted, 0 updated)
2025-05-15 10:28:37,062 [INFO] Closing browser session...
2025-05-15 10:28:37,236 [INFO] Browser session closed
2025-05-15 10:29:57,929 [INFO] Using browser: chromium
2025-05-15 10:29:57,929 [INFO] Creating TikTok API session...
2025-05-15 10:30:19,657 [INFO] TikTok API session created successfully
2025-05-15 10:30:19,657 [INFO] Loading trending videos from TikTok...
2025-05-15 10:30:22,446 [INFO] Found 48 unique videos, attempting to store in database...
2025-05-15 10:30:34,220 [INFO] Successfully processed 48 videos (48 inserted, 0 updated)
2025-05-15 10:30:34,221 [INFO] Closing browser session...
2025-05-15 10:30:34,391 [INFO] Browser session closed
2025-05-15 10:32:43,308 [INFO] Using browser: chromium
2025-05-15 10:32:43,308 [INFO] Creating TikTok API session...
2025-05-15 10:32:50,568 [INFO] TikTok API session created successfully
2025-05-15 10:32:50,568 [INFO] Loading trending videos from TikTok...
2025-05-15 10:32:53,324 [INFO] Found 46 unique videos, attempting to store in database...
2025-05-15 10:33:05,028 [INFO] Successfully processed 46 videos (26 inserted, 20 updated)
2025-05-15 10:33:05,028 [INFO] Closing browser session...
2025-05-15 10:33:05,201 [INFO] Browser session closed
2025-05-15 10:42:13,775 [INFO] Using browser: chromium
2025-05-15 10:42:13,775 [INFO] Using browser: chromium
2025-05-15 10:42:13,775 [INFO] Using browser: chromium
2025-05-15 10:42:13,776 [INFO] Creating TikTok API session...
2025-05-15 10:42:13,776 [INFO] Creating TikTok API session...
2025-05-15 10:42:13,776 [INFO] Creating TikTok API session...
2025-05-15 10:42:35,248 [INFO] TikTok API session created successfully
2025-05-15 10:42:35,248 [INFO] TikTok API session created successfully
2025-05-15 10:42:35,248 [INFO] TikTok API session created successfully
2025-05-15 10:42:35,248 [INFO] Loading trending videos from TikTok...
2025-05-15 10:42:35,248 [INFO] Loading trending videos from TikTok...
2025-05-15 10:42:35,248 [INFO] Loading trending videos from TikTok...
2025-05-15 10:42:37,858 [INFO] Found 51 unique videos, attempting to store in database...
2025-05-15 10:42:37,858 [INFO] Found 51 unique videos, attempting to store in database...
2025-05-15 10:42:37,858 [INFO] Found 51 unique videos, attempting to store in database...
2025-05-15 10:42:50,604 [INFO] Successfully processed 51 videos (25 inserted, 26 updated)
2025-05-15 10:42:50,604 [INFO] Successfully processed 51 videos (25 inserted, 26 updated)
2025-05-15 10:42:50,604 [INFO] Successfully processed 51 videos (25 inserted, 26 updated)
2025-05-15 10:42:50,605 [INFO] Closing browser session...
2025-05-15 10:42:50,605 [INFO] Closing browser session...
2025-05-15 10:42:50,605 [INFO] Closing browser session...
2025-05-15 10:42:50,777 [INFO] Browser session closed
2025-05-15 10:42:50,777 [INFO] Browser session closed
2025-05-15 10:42:50,777 [INFO] Browser session closed
2025-05-15 10:59:17,356 [INFO] Using browser: chromium
2025-05-15 10:59:17,356 [INFO] Using browser: chromium
2025-05-15 10:59:17,356 [INFO] Using browser: chromium
2025-05-15 10:59:17,356 [INFO] Using browser: chromium
2025-05-15 10:59:17,357 [INFO] Creating TikTok API session...
2025-05-15 10:59:17,357 [INFO] Creating TikTok API session...
2025-05-15 10:59:17,357 [INFO] Creating TikTok API session...
2025-05-15 10:59:17,357 [INFO] Creating TikTok API session...
2025-05-15 10:59:37,837 [INFO] TikTok API session created successfully
2025-05-15 10:59:37,837 [INFO] TikTok API session created successfully
2025-05-15 10:59:37,837 [INFO] TikTok API session created successfully
2025-05-15 10:59:37,837 [INFO] TikTok API session created successfully
2025-05-15 10:59:37,838 [INFO] Loading trending videos from TikTok...
2025-05-15 10:59:37,838 [INFO] Loading trending videos from TikTok...
2025-05-15 10:59:37,838 [INFO] Loading trending videos from TikTok...
2025-05-15 10:59:37,838 [INFO] Loading trending videos from TikTok...
2025-05-15 10:59:39,367 [INFO] Found 30 unique videos, attempting to store in database...
2025-05-15 10:59:39,367 [INFO] Found 30 unique videos, attempting to store in database...
2025-05-15 10:59:39,367 [INFO] Found 30 unique videos, attempting to store in database...
2025-05-15 10:59:39,367 [INFO] Found 30 unique videos, attempting to store in database...
2025-05-15 10:59:47,743 [INFO] Successfully processed 30 videos (15 inserted, 15 updated)
2025-05-15 10:59:47,743 [INFO] Successfully processed 30 videos (15 inserted, 15 updated)
2025-05-15 10:59:47,743 [INFO] Successfully processed 30 videos (15 inserted, 15 updated)
2025-05-15 10:59:47,743 [INFO] Successfully processed 30 videos (15 inserted, 15 updated)
2025-05-15 10:59:47,744 [INFO] Closing browser session...
2025-05-15 10:59:47,744 [INFO] Closing browser session...
2025-05-15 10:59:47,744 [INFO] Closing browser session...
2025-05-15 10:59:47,744 [INFO] Closing browser session...
2025-05-15 10:59:47,938 [INFO] Browser session closed
2025-05-15 10:59:47,938 [INFO] Browser session closed
2025-05-15 10:59:47,938 [INFO] Browser session closed
2025-05-15 10:59:47,938 [INFO] Browser session closed
2025-05-15 17:18:06,298 [INFO] Using browser: chromium
2025-05-15 17:18:06,299 [INFO] Creating TikTok API session...
2025-05-15 17:18:26,420 [INFO] TikTok API session created successfully
2025-05-15 17:18:26,421 [INFO] Loading trending videos from TikTok...
2025-05-15 17:18:29,873 [INFO] Found 45 unique videos, attempting to store in database...
2025-05-15 17:18:40,699 [INFO] Successfully processed 45 videos (35 inserted, 10 updated)
2025-05-15 17:18:40,699 [INFO] Closing browser session...
2025-05-15 17:18:40,990 [INFO] Browser session closed
2025-05-15 19:11:28,296 [INFO] TikTok status updated in database
2025-05-15 19:11:28,297 [INFO] Starting TikTok scraping...
2025-05-15 19:11:28,297 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-15 19:11:30,189 [INFO] TikTok status updated in database
2025-05-15 19:28:19,969 [INFO] TikTok status updated in database
2025-05-15 19:28:19,970 [INFO] Starting TikTok scraping...
2025-05-15 19:28:19,970 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-15 19:28:21,926 [INFO] TikTok status updated in database
2025-05-15 19:31:39,295 [INFO] TikTok status updated in database
2025-05-15 19:31:39,296 [INFO] Starting TikTok scraping...
2025-05-15 19:31:39,296 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-15 19:31:41,205 [INFO] TikTok status updated in database
2025-05-15 19:45:10,207 [INFO] TikTok status updated in database
2025-05-15 19:45:10,207 [INFO] Starting TikTok scraping...
2025-05-15 19:45:10,208 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-15 19:45:12,139 [INFO] TikTok status updated in database
2025-05-15 19:57:02,380 [INFO] Using browser: chromium
2025-05-15 19:57:02,380 [ERROR] Error during TikTok scraping: NameError: name 'TikTokApi' is not defined
2025-05-15 19:57:02,381 [ERROR] Traceback (most recent call last):
  File "C:\Users\SofiePischl\Documents\01_HdM\10_ML_OPS\TrendAnalyseSocialMedia\src\scheduler\jobs\tiktok_scraper.py", line 68, in trending_videos
    api = TikTokApi()
          ^^^^^^^^^
NameError: name 'TikTokApi' is not defined. Did you mean: 'TikTokAPI'?

2025-05-15 20:02:05,818 [INFO] TikTok status updated in database
2025-05-15 20:02:05,818 [INFO] Starting TikTok scraping...
2025-05-15 20:02:05,818 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-15 20:02:07,751 [INFO] TikTok status updated in database
2025-05-15 20:16:58,407 [INFO] Using browser: chromium
2025-05-15 20:16:58,407 [ERROR] Error during TikTok scraping: NameError: name 'TikTokApi' is not defined
2025-05-15 20:16:58,409 [ERROR] Traceback (most recent call last):
  File "c:\Users\SofiePischl\Documents\01_HdM\10_ML_OPS\TrendAnalyseSocialMedia\src\scheduler\jobs\tiktok_scraper.py", line 68, in trending_videos
    api = TikTokApi()
          ^^^^^^^^^
NameError: name 'TikTokApi' is not defined. Did you mean: 'TikTokAPI'?

2025-05-15 20:17:19,657 [INFO] Using browser: chromium
2025-05-15 20:17:19,657 [ERROR] Error during TikTok scraping: NameError: name 'TikTokApi' is not defined
2025-05-15 20:17:19,659 [ERROR] Traceback (most recent call last):
  File "c:\Users\SofiePischl\Documents\01_HdM\10_ML_OPS\TrendAnalyseSocialMedia\src\scheduler\jobs\tiktok_scraper.py", line 68, in trending_videos
    api = TikTokApi()
          ^^^^^^^^^
NameError: name 'TikTokApi' is not defined. Did you mean: 'TikTokAPI'?

2025-05-15 20:17:42,114 [INFO] Using browser: chromium
2025-05-15 20:17:42,114 [ERROR] Error during TikTok scraping: NameError: name 'TikTokApi' is not defined
2025-05-15 20:17:42,115 [ERROR] Traceback (most recent call last):
  File "c:\Users\SofiePischl\Documents\01_HdM\10_ML_OPS\TrendAnalyseSocialMedia\src\scheduler\jobs\tiktok_scraper.py", line 68, in trending_videos
    api = TikTokApi()
          ^^^^^^^^^
NameError: name 'TikTokApi' is not defined. Did you mean: 'TikTokAPI'?

2025-05-15 20:18:54,926 [INFO] TikTok status updated in database
2025-05-15 20:18:54,926 [INFO] Starting TikTok scraping...
2025-05-15 20:18:54,927 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-15 20:18:56,835 [INFO] TikTok status updated in database
2025-05-15 20:19:37,674 [INFO] Using browser: chromium
2025-05-15 20:19:37,674 [ERROR] Error during TikTok scraping: NameError: name 'TikTokApi' is not defined
2025-05-15 20:19:37,675 [ERROR] Traceback (most recent call last):
  File "C:\Users\SofiePischl\Documents\01_HdM\10_ML_OPS\TrendAnalyseSocialMedia\src\scheduler\jobs\tiktok_scraper.py", line 68, in trending_videos
    api = TikTokApi()
          ^^^^^^^^^
NameError: name 'TikTokApi' is not defined. Did you mean: 'TikTokAPI'?

2025-05-15 20:19:56,858 [INFO] Using browser: chromium
2025-05-15 20:19:56,858 [INFO] Creating TikTok API session...
2025-05-15 20:19:56,858 [ERROR] Error during TikTok scraping: AttributeError: 'TikTokAPI' object has no attribute 'create_sessions'
2025-05-15 20:19:56,862 [ERROR] Traceback (most recent call last):
  File "C:\Users\SofiePischl\Documents\01_HdM\10_ML_OPS\TrendAnalyseSocialMedia\src\scheduler\jobs\tiktok_scraper.py", line 71, in trending_videos
    await api.create_sessions(
          ^^^^^^^^^^^^^^^^^^^
AttributeError: 'TikTokAPI' object has no attribute 'create_sessions'

2025-05-15 20:19:56,862 [ERROR] Error closing browser: TikTokAPI must be used as a context manager
2025-05-15 20:20:26,557 [INFO] Using browser: chromium
2025-05-15 20:20:26,557 [INFO] Creating TikTok API session...
2025-05-15 20:20:26,557 [ERROR] Error during TikTok scraping: TypeError: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-15 20:20:26,558 [ERROR] Traceback (most recent call last):
  File "C:\Users\SofiePischl\Documents\01_HdM\10_ML_OPS\TrendAnalyseSocialMedia\src\scheduler\jobs\tiktok_scraper.py", line 69, in trending_videos
    async with TikTokAPI(ms_token=ms_token, headless=True) as api:
               ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'TikTokAPI' object does not support the asynchronous context manager protocol

2025-05-15 20:22:58,473 [INFO] Using browser: chromium
2025-05-15 20:22:58,473 [INFO] Creating TikTok API session...
2025-05-15 20:23:08,952 [INFO] TikTok API session created successfully
2025-05-15 20:23:08,952 [INFO] Loading trending videos from TikTok...
2025-05-15 20:23:12,923 [INFO] Found 44 unique videos, attempting to store in database...
2025-05-15 20:23:23,753 [INFO] Successfully processed 44 videos (36 inserted, 8 updated)
2025-05-15 20:25:19,505 [INFO] Using browser: chromium
2025-05-15 20:25:19,505 [INFO] Creating TikTok API session...
2025-05-15 20:25:26,685 [INFO] TikTok API session created successfully
2025-05-15 20:25:26,685 [INFO] Loading trending videos from TikTok...
2025-05-15 20:25:30,787 [INFO] Found 38 unique videos, attempting to store in database...
2025-05-15 20:25:40,172 [INFO] Successfully processed 38 videos (20 inserted, 18 updated)
2025-05-15 20:35:43,419 [INFO] TikTok status updated in database
2025-05-15 20:35:43,421 [INFO] Starting TikTok scraping...
2025-05-15 20:35:43,421 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-15 20:35:45,340 [INFO] TikTok status updated in database
2025-05-15 20:42:25,905 [INFO] Using browser: chromium
2025-05-15 20:42:25,905 [INFO] Creating TikTok API session...
2025-05-15 20:42:33,277 [INFO] TikTok API session created successfully
2025-05-15 20:42:33,278 [INFO] Loading trending videos from TikTok...
2025-05-15 20:42:37,015 [INFO] Found 51 unique videos, attempting to store in database...
2025-05-15 20:42:49,290 [INFO] Successfully processed 51 videos (36 inserted, 15 updated)
2025-05-15 20:52:35,066 [INFO] TikTok status updated in database
2025-05-15 20:52:35,067 [INFO] Starting TikTok scraping...
2025-05-15 20:52:35,067 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-15 20:52:36,979 [INFO] TikTok status updated in database
2025-05-15 20:59:34,067 [INFO] Using browser: chromium
2025-05-15 20:59:34,067 [INFO] Creating TikTok API session...
2025-05-15 20:59:56,706 [INFO] TikTok API session created successfully
2025-05-15 20:59:56,706 [INFO] Loading trending videos from TikTok...
2025-05-15 21:00:00,737 [INFO] Found 41 unique videos, attempting to store in database...
2025-05-15 21:00:10,913 [INFO] Successfully processed 41 videos (17 inserted, 24 updated)
2025-05-15 21:09:24,545 [INFO] TikTok status updated in database
2025-05-15 21:09:24,545 [INFO] Starting TikTok scraping...
2025-05-15 21:09:24,546 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-15 21:09:26,514 [INFO] TikTok status updated in database
2025-05-15 21:16:56,530 [INFO] Using browser: chromium
2025-05-15 21:16:56,531 [INFO] Creating TikTok API session...
2025-05-15 21:17:17,390 [INFO] TikTok API session created successfully
2025-05-15 21:17:17,391 [INFO] Loading trending videos from TikTok...
2025-05-15 21:17:22,696 [INFO] Found 42 unique videos, attempting to store in database...
2025-05-15 21:17:33,262 [INFO] Successfully processed 42 videos (18 inserted, 24 updated)
2025-05-15 21:26:09,248 [INFO] TikTok status updated in database
2025-05-15 21:26:09,250 [INFO] Starting TikTok scraping...
2025-05-15 21:26:09,251 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-15 21:26:11,163 [INFO] TikTok status updated in database
2025-05-15 21:37:40,249 [INFO] Using browser: chromium
2025-05-15 21:37:40,249 [INFO] Creating TikTok API session...
2025-05-15 21:38:00,260 [INFO] TikTok API session created successfully
2025-05-15 21:38:00,260 [INFO] Loading trending videos from TikTok...
2025-05-15 21:38:02,278 [INFO] Found 30 unique videos, attempting to store in database...
2025-05-15 21:39:05,482 [ERROR] Error inserting video 7482456999746227499: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.
server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

2025-05-15 21:39:05,482 [ERROR] Error inserting video 7489631619788098838: cursor already closed
2025-05-15 21:39:05,483 [ERROR] Error inserting video 7479130387642469650: cursor already closed
2025-05-15 21:39:05,483 [ERROR] Error inserting video 7504251289061117202: cursor already closed
2025-05-15 21:39:05,483 [ERROR] Error inserting video 7476419423251729686: cursor already closed
2025-05-15 21:39:05,484 [ERROR] Error inserting video 7494696063702404374: cursor already closed
2025-05-15 21:39:05,484 [ERROR] Error inserting video 7485396935742885151: cursor already closed
2025-05-15 21:39:05,484 [ERROR] Error inserting video : cursor already closed
2025-05-15 21:39:05,485 [ERROR] Error inserting video 7504352996625501462: cursor already closed
2025-05-15 21:39:05,485 [ERROR] Error inserting video 7503158931053743382: cursor already closed
2025-05-15 21:39:05,485 [ERROR] Error inserting video 7474166239930174742: cursor already closed
2025-05-15 21:39:05,486 [ERROR] Error inserting video 7499763497350499586: cursor already closed
2025-05-15 21:39:05,486 [ERROR] Error inserting video 7478823658165751062: cursor already closed
2025-05-15 21:39:05,486 [ERROR] Error inserting video 7504258595861613870: cursor already closed
2025-05-15 21:39:05,486 [ERROR] Error inserting video 7478728535738371350: cursor already closed
2025-05-15 21:39:05,486 [ERROR] Error inserting video 7486656100180299038: cursor already closed
2025-05-15 21:39:05,486 [ERROR] Error inserting video 7479456244944751894: cursor already closed
2025-05-15 21:39:05,656 [ERROR] Error during TikTok scraping: InterfaceError: connection already closed
2025-05-15 21:39:05,657 [ERROR] Traceback (most recent call last):
  File "C:\Users\SofiePischl\Documents\01_HdM\10_ML_OPS\TrendAnalyseSocialMedia\src\scheduler\jobs\tiktok_scraper.py", line 199, in trending_videos
    # Commit changes and log results
psycopg2.InterfaceError: cursor already closed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\SofiePischl\Documents\01_HdM\10_ML_OPS\TrendAnalyseSocialMedia\src\scheduler\jobs\tiktok_scraper.py", line 129, in trending_videos
    # Store data in PostgreSQL
psycopg2.InterfaceError: connection already closed

2025-05-15 21:43:42,895 [ERROR] Error updating TikTok status: connection already closed
2025-05-15 21:43:42,895 [INFO] Starting TikTok scraping...
2025-05-15 21:43:42,895 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-15 21:43:45,883 [INFO] TikTok status updated in database
2025-05-15 22:04:01,529 [ERROR] Database connection error: connection to server at "caboose.proxy.rlwy.net" (34.1.255.159), port 25158 failed: Connection timed out (0x0000274C/10060)
	Is the server running on that host and accepting TCP/IP connections?

2025-05-15 22:04:01,530 [ERROR] Error updating TikTok status: connection to server at "caboose.proxy.rlwy.net" (34.1.255.159), port 25158 failed: Connection timed out (0x0000274C/10060)
	Is the server running on that host and accepting TCP/IP connections?

2025-05-15 22:04:01,530 [INFO] Starting TikTok scraping...
2025-05-15 22:04:01,531 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-15 22:04:10,284 [INFO] TikTok status updated in database
2025-05-15 22:22:49,251 [INFO] TikTok status updated in database
2025-05-15 22:22:49,252 [INFO] Starting TikTok scraping...
2025-05-15 22:22:49,252 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-15 22:23:10,304 [ERROR] Database connection error: connection to server at "caboose.proxy.rlwy.net" (34.1.255.159), port 25158 failed: Connection timed out (0x0000274C/10060)
	Is the server running on that host and accepting TCP/IP connections?

2025-05-15 22:23:10,305 [ERROR] Error updating TikTok status: connection to server at "caboose.proxy.rlwy.net" (34.1.255.159), port 25158 failed: Connection timed out (0x0000274C/10060)
	Is the server running on that host and accepting TCP/IP connections?

2025-05-15 22:41:25,668 [INFO] TikTok status updated in database
2025-05-15 22:41:25,668 [INFO] Starting TikTok scraping...
2025-05-15 22:41:25,669 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-15 22:41:27,645 [INFO] TikTok status updated in database
2025-05-15 22:58:13,843 [INFO] TikTok status updated in database
2025-05-15 22:58:13,843 [INFO] Starting TikTok scraping...
2025-05-15 22:58:13,843 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-15 22:58:15,748 [INFO] TikTok status updated in database
2025-05-15 23:15:00,399 [INFO] TikTok status updated in database
2025-05-15 23:15:00,399 [INFO] Starting TikTok scraping...
2025-05-15 23:15:00,399 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-15 23:15:02,444 [INFO] TikTok status updated in database
2025-05-15 23:31:48,323 [INFO] TikTok status updated in database
2025-05-15 23:31:48,324 [INFO] Starting TikTok scraping...
2025-05-15 23:31:48,324 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-15 23:31:50,321 [INFO] TikTok status updated in database
2025-05-15 23:48:34,353 [INFO] TikTok status updated in database
2025-05-15 23:48:34,354 [INFO] Starting TikTok scraping...
2025-05-15 23:48:34,354 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-15 23:48:36,243 [INFO] TikTok status updated in database
2025-05-15 23:55:48,131 [INFO] Using browser: chromium
2025-05-15 23:55:48,132 [INFO] Creating TikTok API session...
2025-05-15 23:56:08,259 [INFO] TikTok API session created successfully
2025-05-15 23:56:08,259 [INFO] Loading trending videos from TikTok...
2025-05-15 23:56:11,187 [INFO] Found 37 unique videos, attempting to store in database...
2025-05-15 23:56:20,720 [INFO] Successfully processed 37 videos (13 inserted, 24 updated)
2025-05-16 05:15:52,136 [INFO] Using browser: chromium
2025-05-16 05:15:52,136 [INFO] Creating TikTok API session...
2025-05-16 05:15:53,793 [INFO] TikTok status updated in database
2025-05-16 05:15:53,794 [INFO] Starting TikTok scraping...
2025-05-16 05:15:53,794 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-16 05:15:56,089 [INFO] TikTok status updated in database
2025-05-16 05:16:00,431 [INFO] TikTok API session created successfully
2025-05-16 05:16:00,431 [INFO] Loading trending videos from TikTok...
2025-05-16 05:16:01,654 [INFO] Found 30 unique videos, attempting to store in database...
2025-05-16 05:16:11,141 [INFO] Successfully processed 30 videos (20 inserted, 10 updated)
2025-05-16 08:20:09,478 [INFO] TikTok status updated in database
2025-05-16 08:20:09,479 [INFO] Starting TikTok scraping...
2025-05-16 08:20:09,479 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-16 08:20:11,900 [INFO] TikTok status updated in database
2025-05-16 08:35:06,858 [INFO] Using browser: chromium
2025-05-16 08:35:06,858 [INFO] Creating TikTok API session...
2025-05-16 08:35:25,177 [INFO] TikTok API session created successfully
2025-05-16 08:35:25,177 [INFO] Loading trending videos from TikTok...
2025-05-16 08:35:26,470 [INFO] Found 30 unique videos, attempting to store in database...
2025-05-16 08:35:36,267 [INFO] Successfully processed 30 videos (17 inserted, 13 updated)
2025-05-16 08:37:22,349 [INFO] TikTok status updated in database
2025-05-16 08:37:22,351 [INFO] Starting TikTok scraping...
2025-05-16 08:37:22,352 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-16 08:37:24,747 [INFO] TikTok status updated in database
2025-05-16 08:52:43,471 [INFO] Using browser: chromium
2025-05-16 08:52:43,472 [INFO] Creating TikTok API session...
2025-05-16 08:53:04,898 [INFO] TikTok API session created successfully
2025-05-16 08:53:04,898 [INFO] Loading trending videos from TikTok...
2025-05-16 08:53:07,813 [INFO] Found 38 unique videos, attempting to store in database...
2025-05-16 08:53:19,173 [INFO] Successfully processed 38 videos (20 inserted, 18 updated)
2025-05-16 08:54:39,034 [INFO] TikTok status updated in database
2025-05-16 08:54:39,036 [INFO] Starting TikTok scraping...
2025-05-16 08:54:39,036 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-16 08:54:41,330 [INFO] TikTok status updated in database
2025-05-16 09:10:25,034 [INFO] Using browser: chromium
2025-05-16 09:10:25,035 [INFO] Creating TikTok API session...
2025-05-16 09:10:45,533 [INFO] TikTok API session created successfully
2025-05-16 09:10:45,534 [INFO] Loading trending videos from TikTok...
2025-05-16 09:10:48,541 [INFO] Found 50 unique videos, attempting to store in database...
2025-05-16 09:11:03,354 [INFO] Successfully processed 50 videos (31 inserted, 19 updated)
2025-05-16 09:11:51,923 [INFO] TikTok status updated in database
2025-05-16 09:11:51,923 [INFO] Starting TikTok scraping...
2025-05-16 09:11:51,924 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-16 09:11:54,287 [INFO] TikTok status updated in database
2025-05-16 09:28:09,939 [INFO] Using browser: chromium
2025-05-16 09:28:09,939 [INFO] Creating TikTok API session...
2025-05-16 09:28:31,063 [INFO] TikTok API session created successfully
2025-05-16 09:28:31,063 [INFO] Loading trending videos from TikTok...
2025-05-16 09:28:33,529 [INFO] Found 47 unique videos, attempting to store in database...
2025-05-16 09:28:47,275 [INFO] Successfully processed 47 videos (15 inserted, 32 updated)
2025-05-16 09:29:05,735 [INFO] TikTok status updated in database
2025-05-16 09:29:05,736 [INFO] Starting TikTok scraping...
2025-05-16 09:29:05,736 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-16 09:29:08,049 [INFO] TikTok status updated in database
2025-05-16 09:45:58,631 [INFO] Using browser: chromium
2025-05-16 09:45:58,632 [INFO] Creating TikTok API session...
2025-05-16 09:46:19,167 [INFO] TikTok API session created successfully
2025-05-16 09:46:19,168 [INFO] Loading trending videos from TikTok...
2025-05-16 09:46:19,738 [INFO] TikTok status updated in database
2025-05-16 09:46:19,739 [INFO] Starting TikTok scraping...
2025-05-16 09:46:19,740 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-16 09:46:21,813 [INFO] Found 43 unique videos, attempting to store in database...
2025-05-16 09:46:22,065 [INFO] TikTok status updated in database
2025-05-16 09:46:34,612 [INFO] Successfully processed 43 videos (14 inserted, 29 updated)
2025-05-16 10:03:34,770 [INFO] TikTok status updated in database
2025-05-16 10:03:34,771 [INFO] Starting TikTok scraping...
2025-05-16 10:03:34,772 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-16 10:03:37,117 [INFO] TikTok status updated in database
2025-05-16 10:03:45,369 [INFO] Using browser: chromium
2025-05-16 10:03:45,369 [INFO] Creating TikTok API session...
2025-05-16 10:04:10,425 [INFO] TikTok API session created successfully
2025-05-16 10:04:10,426 [INFO] Loading trending videos from TikTok...
2025-05-16 10:04:11,817 [INFO] Found 30 unique videos, attempting to store in database...
2025-05-16 10:04:22,061 [INFO] Successfully processed 30 videos (6 inserted, 24 updated)
2025-05-16 10:20:28,110 [INFO] TikTok status updated in database
2025-05-16 10:20:28,111 [INFO] Starting TikTok scraping...
2025-05-16 10:20:28,111 [ERROR] Error during TikTok scraping: 'TikTokAPI' object does not support the asynchronous context manager protocol
2025-05-16 10:20:30,049 [INFO] TikTok status updated in database
2025-05-16 10:21:08,883 [INFO] Using browser: chromium
2025-05-16 10:21:08,883 [INFO] Creating TikTok API session...
2025-05-16 10:21:31,065 [INFO] TikTok API session created successfully
2025-05-16 10:21:31,066 [INFO] Loading trending videos from TikTok...
2025-05-16 10:21:34,118 [INFO] Found 34 unique videos, attempting to store in database...
2025-05-16 10:21:42,850 [INFO] Successfully processed 34 videos (12 inserted, 22 updated)
