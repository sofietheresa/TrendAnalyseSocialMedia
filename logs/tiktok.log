2025-05-15 10:17:05,943 [INFO] Using browser: chromium
2025-05-15 10:17:05,943 [INFO] Creating TikTok API session...
2025-05-15 10:17:17,721 [INFO] TikTok API session created successfully
2025-05-15 10:17:17,722 [INFO] Loading trending videos from TikTok...
2025-05-15 10:17:20,698 [INFO] Found 58 videos, attempting to store in database...
2025-05-15 10:17:23,675 [ERROR] Error during TikTok scraping: CardinalityViolation: ON CONFLICT DO UPDATE command cannot affect row a second time
HINT:  Ensure that no rows proposed for insertion within the same command have duplicate constrained values.

2025-05-15 10:17:23,709 [ERROR] Traceback (most recent call last):
  File "C:\Users\SofiePischl\Documents\01_HdM\10_ML_OPS\TrendAnalyseSocialMedia\src\scheduler\jobs\tiktok_scraper.py", line 175, in trending_videos
    execute_values(cur, insert_query, values)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SofiePischl\Documents\01_HdM\10_ML_OPS\TrendAnalyseSocialMedia\venv\Lib\site-packages\psycopg2\extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
psycopg2.errors.CardinalityViolation: ON CONFLICT DO UPDATE command cannot affect row a second time
HINT:  Ensure that no rows proposed for insertion within the same command have duplicate constrained values.


2025-05-15 10:17:23,732 [INFO] Closing browser session...
2025-05-15 10:17:24,005 [INFO] Browser session closed
2025-05-15 10:18:10,680 [INFO] Using browser: chromium
2025-05-15 10:18:10,681 [INFO] Creating TikTok API session...
2025-05-15 10:18:19,522 [INFO] TikTok API session created successfully
2025-05-15 10:18:19,522 [INFO] Loading trending videos from TikTok...
2025-05-15 10:18:22,472 [INFO] Found 46 unique videos, attempting to store in database...
2025-05-15 10:18:35,351 [INFO] Successfully processed 46 videos (46 inserted, 0 updated)
2025-05-15 10:18:35,352 [INFO] Closing browser session...
2025-05-15 10:18:35,787 [INFO] Browser session closed
2025-05-15 10:25:24,073 [INFO] Using browser: chromium
2025-05-15 10:25:24,073 [INFO] Using browser: chromium
2025-05-15 10:25:24,073 [INFO] Creating TikTok API session...
2025-05-15 10:25:24,073 [INFO] Creating TikTok API session...
2025-05-15 10:25:33,153 [INFO] TikTok API session created successfully
2025-05-15 10:25:33,153 [INFO] TikTok API session created successfully
2025-05-15 10:25:33,154 [INFO] Loading trending videos from TikTok...
2025-05-15 10:25:33,154 [INFO] Loading trending videos from TikTok...
2025-05-15 10:25:35,673 [INFO] Found 42 unique videos, attempting to store in database...
2025-05-15 10:25:35,673 [INFO] Found 42 unique videos, attempting to store in database...
2025-05-15 10:25:46,019 [INFO] Successfully processed 42 videos (28 inserted, 14 updated)
2025-05-15 10:25:46,019 [INFO] Successfully processed 42 videos (28 inserted, 14 updated)
2025-05-15 10:25:46,020 [INFO] Closing browser session...
2025-05-15 10:25:46,020 [INFO] Closing browser session...
2025-05-15 10:25:46,294 [INFO] Browser session closed
2025-05-15 10:25:46,294 [INFO] Browser session closed
2025-05-15 10:26:57,020 [INFO] Using browser: chromium
2025-05-15 10:26:57,020 [INFO] Creating TikTok API session...
2025-05-15 10:27:06,288 [INFO] TikTok API session created successfully
2025-05-15 10:27:06,288 [INFO] Loading trending videos from TikTok...
2025-05-15 10:27:08,959 [INFO] Found 49 unique videos, attempting to store in database...
2025-05-15 10:27:11,444 [ERROR] Error inserting video 7500052768854527239: value too long for type character varying(500)

2025-05-15 10:27:11,644 [ERROR] Error inserting video 7501054052168404255: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:11,844 [ERROR] Error inserting video 7476823939214216450: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:12,043 [ERROR] Error inserting video 7481775457415761198: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:12,243 [ERROR] Error inserting video 7501480772889627922: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:12,443 [ERROR] Error inserting video 7494696063702404374: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:12,642 [ERROR] Error inserting video 7474118918395661575: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:12,842 [ERROR] Error inserting video 7471679068027522326: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:13,041 [ERROR] Error inserting video 7474528587148758295: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:13,239 [ERROR] Error inserting video 7498879676245658926: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:13,439 [ERROR] Error inserting video 7492757313153994006: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:13,638 [ERROR] Error inserting video 7475814602916334870: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:13,836 [ERROR] Error inserting video 7496039067130334470: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:14,036 [ERROR] Error inserting video 7496914740623559958: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:14,236 [ERROR] Error inserting video 7483152862151806263: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:14,434 [ERROR] Error inserting video 7503639568281881878: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:14,633 [ERROR] Error inserting video 7502861868353080598: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:14,832 [ERROR] Error inserting video : current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:15,031 [ERROR] Error inserting video 7476648017790012678: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:15,230 [ERROR] Error inserting video 7473144580179774738: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:15,430 [ERROR] Error inserting video 7503541894769560854: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:15,629 [ERROR] Error inserting video 7479456244944751894: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:15,827 [ERROR] Error inserting video 7481813647522598166: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:16,026 [ERROR] Error inserting video 7503868936870432022: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:16,224 [ERROR] Error inserting video 7483581945390173462: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:16,423 [ERROR] Error inserting video 7476642558618225942: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:16,624 [ERROR] Error inserting video 7498014529620692246: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:16,823 [ERROR] Error inserting video 7497685667518926088: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:17,022 [ERROR] Error inserting video 7503925557046856993: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:17,222 [ERROR] Error inserting video 7474302176660147478: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:17,420 [ERROR] Error inserting video 7500744842771729670: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:17,619 [ERROR] Error inserting video 7500893295145536790: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:17,819 [ERROR] Error inserting video 7475062603996237057: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:18,019 [ERROR] Error inserting video 7478360823220440325: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:18,229 [ERROR] Error inserting video 7494291431025036566: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:18,428 [ERROR] Error inserting video 7472307236350463254: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:18,627 [ERROR] Error inserting video 7491995339071720726: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:18,826 [ERROR] Error inserting video 7497754448006040854: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:19,024 [ERROR] Error inserting video 7485308200527498498: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:19,222 [ERROR] Error inserting video 7473376559013907734: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:19,420 [ERROR] Error inserting video 7477991944031964438: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:19,619 [ERROR] Error inserting video 7475114379977968918: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:19,817 [ERROR] Error inserting video 7494793912201055543: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:20,016 [ERROR] Error inserting video 7491951798823980310: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:20,215 [ERROR] Error inserting video 7479585258816474390: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:20,413 [ERROR] Error inserting video 7484270224783592710: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:20,612 [ERROR] Error inserting video 7472779684124675350: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:27:20,812 [INFO] Successfully processed 49 videos (2 inserted, 0 updated)
2025-05-15 10:27:20,812 [INFO] Closing browser session...
2025-05-15 10:27:20,990 [INFO] Browser session closed
2025-05-15 10:28:16,159 [INFO] Using browser: chromium
2025-05-15 10:28:16,159 [INFO] Creating TikTok API session...
2025-05-15 10:28:27,060 [INFO] TikTok API session created successfully
2025-05-15 10:28:27,060 [INFO] Loading trending videos from TikTok...
2025-05-15 10:28:28,428 [INFO] Found 30 unique videos, attempting to store in database...
2025-05-15 10:28:30,848 [ERROR] Error inserting video 7501767141276781842: value too long for type character varying(500)

2025-05-15 10:28:31,049 [ERROR] Error inserting video 7502820049514827054: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:31,249 [ERROR] Error inserting video 7497677779564121350: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:31,449 [ERROR] Error inserting video 7497584770533068074: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:31,648 [ERROR] Error inserting video 7484651212701289750: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:31,906 [ERROR] Error inserting video 7502407828070567190: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:32,105 [ERROR] Error inserting video 7501393704754728214: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:32,353 [ERROR] Error inserting video 7492757313153994006: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:32,557 [ERROR] Error inserting video 7476823939214216450: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:32,762 [ERROR] Error inserting video 7503659125176372503: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:32,967 [ERROR] Error inserting video 7501480772889627922: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:33,172 [ERROR] Error inserting video 7500533345068010774: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:33,377 [ERROR] Error inserting video 7503543054603767062: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:33,582 [ERROR] Error inserting video 7494793912201055543: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:33,782 [ERROR] Error inserting video 7503598295923658027: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:33,991 [ERROR] Error inserting video 7503869597167127825: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:34,195 [ERROR] Error inserting video 7495116577369509150: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:34,401 [ERROR] Error inserting video 7503690966822440223: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:34,603 [ERROR] Error inserting video 7501768849553919254: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:34,823 [ERROR] Error inserting video 7501682466655161622: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:35,022 [ERROR] Error inserting video : current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:35,263 [ERROR] Error inserting video 7502450730058435862: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:35,462 [ERROR] Error inserting video 7497754448006040854: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:35,662 [ERROR] Error inserting video 7496914740623559958: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:35,863 [ERROR] Error inserting video 7503865645805751574: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:36,062 [ERROR] Error inserting video 7495363069288205600: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:36,261 [ERROR] Error inserting video 7500052768854527239: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:36,461 [ERROR] Error inserting video 7473144580179774738: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:36,661 [ERROR] Error inserting video 7503944989190180118: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:36,861 [ERROR] Error inserting video 7496039067130334470: current transaction is aborted, commands ignored until end of transaction block

2025-05-15 10:28:37,061 [INFO] Successfully processed 30 videos (0 inserted, 0 updated)
2025-05-15 10:28:37,062 [INFO] Closing browser session...
2025-05-15 10:28:37,236 [INFO] Browser session closed
2025-05-15 10:29:57,929 [INFO] Using browser: chromium
2025-05-15 10:29:57,929 [INFO] Creating TikTok API session...
2025-05-15 10:30:19,657 [INFO] TikTok API session created successfully
2025-05-15 10:30:19,657 [INFO] Loading trending videos from TikTok...
2025-05-15 10:30:22,446 [INFO] Found 48 unique videos, attempting to store in database...
2025-05-15 10:30:34,220 [INFO] Successfully processed 48 videos (48 inserted, 0 updated)
2025-05-15 10:30:34,221 [INFO] Closing browser session...
2025-05-15 10:30:34,391 [INFO] Browser session closed
2025-05-15 10:32:43,308 [INFO] Using browser: chromium
2025-05-15 10:32:43,308 [INFO] Creating TikTok API session...
2025-05-15 10:32:50,568 [INFO] TikTok API session created successfully
2025-05-15 10:32:50,568 [INFO] Loading trending videos from TikTok...
2025-05-15 10:32:53,324 [INFO] Found 46 unique videos, attempting to store in database...
2025-05-15 10:33:05,028 [INFO] Successfully processed 46 videos (26 inserted, 20 updated)
2025-05-15 10:33:05,028 [INFO] Closing browser session...
2025-05-15 10:33:05,201 [INFO] Browser session closed
2025-05-15 10:42:13,775 [INFO] Using browser: chromium
2025-05-15 10:42:13,775 [INFO] Using browser: chromium
2025-05-15 10:42:13,775 [INFO] Using browser: chromium
2025-05-15 10:42:13,776 [INFO] Creating TikTok API session...
2025-05-15 10:42:13,776 [INFO] Creating TikTok API session...
2025-05-15 10:42:13,776 [INFO] Creating TikTok API session...
2025-05-15 10:42:35,248 [INFO] TikTok API session created successfully
2025-05-15 10:42:35,248 [INFO] TikTok API session created successfully
2025-05-15 10:42:35,248 [INFO] TikTok API session created successfully
2025-05-15 10:42:35,248 [INFO] Loading trending videos from TikTok...
2025-05-15 10:42:35,248 [INFO] Loading trending videos from TikTok...
2025-05-15 10:42:35,248 [INFO] Loading trending videos from TikTok...
2025-05-15 10:42:37,858 [INFO] Found 51 unique videos, attempting to store in database...
2025-05-15 10:42:37,858 [INFO] Found 51 unique videos, attempting to store in database...
2025-05-15 10:42:37,858 [INFO] Found 51 unique videos, attempting to store in database...
2025-05-15 10:42:50,604 [INFO] Successfully processed 51 videos (25 inserted, 26 updated)
2025-05-15 10:42:50,604 [INFO] Successfully processed 51 videos (25 inserted, 26 updated)
2025-05-15 10:42:50,604 [INFO] Successfully processed 51 videos (25 inserted, 26 updated)
2025-05-15 10:42:50,605 [INFO] Closing browser session...
2025-05-15 10:42:50,605 [INFO] Closing browser session...
2025-05-15 10:42:50,605 [INFO] Closing browser session...
2025-05-15 10:42:50,777 [INFO] Browser session closed
2025-05-15 10:42:50,777 [INFO] Browser session closed
2025-05-15 10:42:50,777 [INFO] Browser session closed
